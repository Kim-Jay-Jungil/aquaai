<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>aqua.ai — 내가 본 바다를 AI로 재현하다</title>
  <link rel="stylesheet" href="/styles.css" />
  <meta name="description" content="드래그 없이 마우스만 움직여도 전/후가 즉시 비교됩니다. 업로드만 하세요." />
</head>
<body>
  <header class="site-header">
    <div class="container nav">
      <a class="logo" href="/">aqua.ai</a>
      <nav class="nav-actions">
        <a class="link" href="/upload.html">업로드</a>
        <span class="divider"></span>
        <span id="auth-box" class="auth-box">로그인 로딩…</span>
      </nav>
    </div>
  </header>

  <section class="hero">
    <div class="container hero-grid">
      <div class="hero-copy">
        <h1 class="hero-title">내가 본 바다를 <span class="hi">AI</span>로 재현하다</h1>
        <p class="hero-sub">드래그 없이 마우스만 움직여도 전/후가 즉시 비교됩니다. 업로드만 하세요.</p>
        <div class="cta-row">
          <a class="btn btn-primary" href="/upload.html">무료로 시작</a>
          <a class="btn btn-ghost" href="#pricing">요금 보기</a>
        </div>
        <p class="meta">ReviewScore <b>4.9</b> | <b>9K+</b> Reviews</p>
      </div>

      <div class="hero-demo">
        <div class="ba" id="heroBA">
          <img class="ba-img ba-before" alt="before"
               src="https://images.unsplash.com/photo-1520256862855-398228c41684?w=1600&q=80&auto=format&fit=crop" />
          <img class="ba-img ba-after" alt="after"
               src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=1600&q=80&auto=format&fit=crop" />
          <div class="ba-divider"></div>
          <div class="ba-handle" aria-label="비교 핸들" role="slider" tabindex="0"></div>
          <div class="ba-badge before">Before</div>
          <div class="ba-badge after">After</div>
        </div>
      </div>
    </div>
  </section>

  <section class="features">
    <div class="container">
      <h2>What you can do with <span class="logo-inline">aqua.ai</span></h2>
      <div class="cards">
        <article class="card"><h3>AI 1. 색상을 복원</h3><ul>
          <li>적/난색 스펙트럼 복원, 녹/청 캐스트 제거</li>
          <li>화이트밸런스→스펙트럼 보정, 피부 톤 보호</li>
          <li>권장 입력: RAW / 고품질 JPEG(12–48MP)</li>
        </ul></article>
        <article class="card"><h3>AI 2. 부유물 제거</h3><ul>
          <li>부유물 반사 억제</li><li>입자 마스크 추정 + 적응형 디노이즈</li>
          <li>팁: Dehaze와 함께 쓰면 대비↑</li>
        </ul></article>
        <article class="card"><h3>AI 3. 잔상 복원</h3><ul>
          <li>흔들림/모션 블러 개선</li><li>비선형 디블러 + 안정화</li>
          <li>사람/생물 피사체에 효과적</li>
        </ul></article>
        <article class="card"><h3>AI 4. 해상도 ↑</h3><ul>
          <li>노이즈 증폭 없이 4× 업스케일</li>
          <li>텍스처 보강 + 노이즈 억제</li>
          <li>웹 2560px, 인화 A3=4K 권장</li>
        </ul></article>
      </div>
    </div>
  </section>

  <section id="pricing" class="pricing">
    <div class="container">
      <h2>Pricing</h2>
      <div class="price-cards">
        <div class="price-card">
          <h3>Free</h3><p class="price">$0</p>
          <ul><li>월 10장</li><li>최대 12MP</li><li>워터마크</li><li>기본 모델 2종</li></ul>
          <a class="btn btn-ghost" href="/upload.html">시작</a>
        </div>
        <div class="price-card rec">
          <div class="badge">추천</div>
          <h3>Basic</h3><p class="price">$13.99/mo</p>
          <ul><li>70 ops</li><li>워터마크 없음</li><li>4 모델</li><li>최대 48MP</li></ul>
          <a class="btn btn-primary" id="btnUpgradeBasic">업그레이드</a>
        </div>
        <div class="price-card">
          <h3>Pro</h3><p class="price">$29/mo</p>
          <ul><li>200 ops</li><li>우선 처리</li><li>배치 업로드</li></ul>
          <a class="btn btn-ghost" id="btnUpgradePro">업그레이드</a>
        </div>
        <div class="price-card">
          <h3>Studio</h3><p class="price">$199/mo</p>
          <ul><li>무제한</li><li>팀/SLA</li><li>상업용 포함</li></ul>
          <a class="btn btn-ghost" id="btnUpgradeStudio">업그레이드</a>
        </div>
      </div>
    </div>
  </section>

  <footer class="site-footer">
    <div class="container foot">
      <span>© aqua.ai — Dive safer, shoot better, edit smarter.</span>
      <a class="link" href="/upload.html">업로드</a>
    </div>
  </footer>

  <!-- ClerkJS -->
  <script async crossorigin="anonymous"
    data-clerk-publishable-key="pk_test_cHJvZm91bmQtbGFicmFkb3ItNDAuY2xlcmsuYWNjb3VudHMuZGV2JA"
    src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"></script>

  <script>
    const CLERK_PORTAL = 'https://profound-labrador-40.clerk.accounts.dev';

    // Plan/feature 헬퍼 (세션 클레임/메타데이터에서 가능한 키를 최대한 유연하게 읽음)
    function getPlanAndFeatures() {
      const claims = (window.Clerk?.session?.claims) || {};
      const user = window.Clerk?.user || {};
      const pm = (user.publicMetadata || {});
      const plan =
        (claims.subscription_plan || claims.plan || pm.plan || 'free') + '';
      const features =
        claims.features || pm.features || {};
      return { plan: plan.toLowerCase(), features };
    }

    window.addEventListener('load', async () => {
      await window.Clerk.load();

      // 헤더 로그인/플랜 UI
      const box = document.getElementById('auth-box');
      if (window.Clerk.user) {
        const n = window.Clerk.user.firstName || window.Clerk.user.username ||
                  (window.Clerk.user.emailAddresses?.[0]?.emailAddress ?? '회원');
        const { plan } = getPlanAndFeatures();
        box.innerHTML = `
          <span class="u-welcome">안녕하세요, ${n}님 · <span class="plan-tag">${plan}</span></span>
          <a class="btn btn-xs btn-line" href="${CLERK_PORTAL}/user">요금제 관리</a>
          <button class="btn btn-xs" id="logoutBtn">로그아웃</button>`;
        document.getElementById('logoutBtn').onclick = () =>
          window.Clerk.signOut({ redirectUrl: '/' });
      } else {
        box.innerHTML = `
          <a class="btn btn-xs" href="${CLERK_PORTAL}/sign-in?redirect_url=${encodeURIComponent(location.origin + '/')}">로그인</a>
          <a class="btn btn-xs btn-line" href="${CLERK_PORTAL}/sign-up?redirect_url=${encodeURIComponent(location.origin + '/')}">회원가입</a>`;
      }

      // 가격 카드 업그레이드 버튼은 로그인 상태면 포털로 이동
      ['Basic','Pro','Studio'].forEach(tier => {
        const el = document.getElementById('btnUpgrade'+tier);
        if (!el) return;
        el.addEventListener('click', () => {
          location.href = `${CLERK_PORTAL}/user`;
        });
      });
    });

    // BA(전/후) 슬라이더
    function mountBA(root){
      const before=root.querySelector('.ba-before');
      const divider=root.querySelector('.ba-divider');
      const handle=root.querySelector('.ba-handle');
      let pct=50;
      const setPct=(p)=>{ pct=Math.max(0,Math.min(100,p));
        before.style.clipPath=`inset(0 ${100-pct}% 0 0)`; divider.style.left=pct+'%'; handle.style.left=pct+'%';};
      const rect=()=>root.getBoundingClientRect();
      const onMove=(x)=>{const r=rect(); const clamped=Math.max(r.left,Math.min(x,r.right));
        const p=((clamped-r.left)/r.width)*100; setPct(p);};
      root.addEventListener('mousemove',e=>onMove(e.clientX),{passive:true});
      root.addEventListener('touchmove',e=>onMove(e.touches[0].clientX),{passive:true});
      setPct(pct);
    }
    window.addEventListener('DOMContentLoaded',()=>{ const el=document.getElementById('heroBA'); if(el) mountBA(el); });
  </script>
</body>
</html>